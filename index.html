<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>EspiriQuiz v3.2 Perfect</title>
<script src="https://cdn.tailwindcss.com"></script>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');
*{box-sizing:border-box;margin:0;padding:0}
body{background:radial-gradient(circle at top,#1a1a2e,#0f0f1e,#000);color:#e2e8f0;font-family:'Poppins',sans-serif;overflow-x:hidden}
.glow-text{text-shadow:0 0 20px rgba(139,92,246,0.6)}
.btn-primary{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);transition:all .3s}
.btn-primary:hover{transform:scale(1.05);box-shadow:0 10px 30px rgba(102,126,234,0.4)}
.btn-secondary{background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%)}
.btn-success{background:linear-gradient(135deg,#10b981 0%,#059669 100%)}
.xp-bar{background:linear-gradient(90deg,#667eea,#764ba2,#f093fb);height:8px;border-radius:999px;transition:width .5s;box-shadow:0 0 10px rgba(102,126,234,0.5)}
.level-badge{background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;padding:4px 12px;border-radius:999px;font-weight:800;font-size:.75rem}
@keyframes fire{0%,100%{transform:scale(1) rotate(0)}50%{transform:scale(1.1) rotate(5deg)}}
.streak-fire{animation:fire 1s ease-in-out infinite}
.mission-card{border-left:4px solid;transition:all .3s}
.mission-incomplete{border-color:#6366f1;background:rgba(99,102,241,0.1)}
.mission-complete{border-color:#10b981;background:rgba(16,185,129,0.1)}
.blitz-timer{font-size:4rem;font-weight:800}
.blitz-urgent{animation:urgent .5s ease-in-out infinite;color:#ef4444!important}
@keyframes urgent{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
.sound-control{position:fixed;top:20px;right:20px;z-index:1000}
.exit-button{position:fixed;top:20px;left:20px;z-index:1000}
.card-glow{box-shadow:0 0 30px rgba(139,92,246,0.15);transition:all .3s}
.correct-answer{animation:pulse .6s;background:linear-gradient(135deg,#10b981,#059669)!important}
.wrong-answer{animation:shake .6s;background:linear-gradient(135deg,#ef4444,#dc2626)!important}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-10px)}75%{transform:translateX(10px)}}
.ai-message{background:linear-gradient(135deg,rgba(139,92,246,0.2),rgba(99,102,241,0.2));border-left:4px solid #8b5cf6;padding:1rem;border-radius:0.5rem;margin-top:1rem}
.loading-dots::after{content:'...';animation:dots 1.5s steps(4,end) infinite}
@keyframes dots{0%,20%{content:'.'}40%{content:'..'}60%,100%{content:'...'}}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useRef}=React

// ========== CONFIGURE SUA CHAVE API AQUI ==========
const GEMINI_API_KEY = 'SUA_CHAVE_API_AQUI'
// Obtenha em: https://makersuite.google.com/app/apikey
// ===================================================

const LEVELS=[
{level:1,name:'Aprendiz',minXP:0,maxXP:1000,icon:'ğŸŒ±',color:'#10b981'},
{level:2,name:'Estudioso',minXP:1000,maxXP:3000,icon:'ğŸ“–',color:'#3b82f6'},
{level:3,name:'Conhecedor',minXP:3000,maxXP:7000,icon:'ğŸ“',color:'#8b5cf6'},
{level:4,name:'SÃ¡bio',minXP:7000,maxXP:15000,icon:'ğŸ§™',color:'#f59e0b'},
{level:5,name:'Mestre',minXP:15000,maxXP:30000,icon:'ğŸ‘‘',color:'#ef4444'},
{level:6,name:'Iluminado',minXP:30000,maxXP:999999,icon:'âœ¨',color:'#ffd700'}
]

const BADGES=[
{id:'cap1',name:'Conhecedor de Deus',icon:'âš¡',desc:'Domine CapÃ­tulo I'},
{id:'cap2',name:'Amigo dos EspÃ­ritos',icon:'ğŸ‘»',desc:'Domine CapÃ­tulo II'},
{id:'first',name:'Primeira Luz',icon:'ğŸŒŸ',desc:'Primeira vitÃ³ria'},
{id:'perfect',name:'PerfeiÃ§Ã£o',icon:'ğŸ’¯',desc:'100% acertos'},
{id:'speed',name:'RelÃ¢mpago',icon:'âš¡',desc:'< 3 minutos'},
{id:'streak7',name:'Semana Sagrada',icon:'ğŸ“…',desc:'7 dias seguidos'},
{id:'streak30',name:'MÃªs Iluminado',icon:'ğŸŒ™',desc:'30 dias'},
{id:'xp5k',name:'AscensÃ£o',icon:'ğŸš€',desc:'5000 XP'},
{id:'xp15k',name:'TranscendÃªncia',icon:'ğŸ’«',desc:'15000 XP'},
{id:'blitz',name:'Rei do Blitz',icon:'ğŸ‘‘',desc:'VenÃ§a Blitz'}
]

function shuffleArray(array){
const arr=[...array]
for(let i=arr.length-1;i>0;i--){
const j=Math.floor(Math.random()*(i+1));
[arr[i],arr[j]]=[arr[j],arr[i]]
}
return arr
}

function App(){
const[bank,setBank]=useState([])
const[questions,setQuestions]=useState([])
const[idx,setIdx]=useState(0)
const[score,setScore]=useState(0)
const[view,setView]=useState("menu")
const[feedback,setFeedback]=useState(null)
const[selectedAnswer,setSelectedAnswer]=useState(null)
const[difficulty,setDifficulty]=useState("normal")
const[selectedChapter,setSelectedChapter]=useState("Todos")
const[soundEnabled,setSoundEnabled]=useState(true)
const[startTime,setStartTime]=useState(null)
const[studyMode,setStudyMode]=useState(false)

const[xp,setXP]=useState(0)
const[level,setLevel]=useState(1)
const[streak,setStreak]=useState(0)
const[lastLogin,setLastLogin]=useState(null)
const[badges,setBadges]=useState([])
const[missions,setMissions]=useState([])
const[blitzMode,setBlitzMode]=useState(false)
const[blitzTimer,setBlitzTimer]=useState(15)

const[aiMentorTip,setAiMentorTip]=useState(null)
const[aiDeepDive,setAiDeepDive]=useState(null)
const[loadingAI,setLoadingAI]=useState(false)

useEffect(()=>{
fetch("questions_complete.json").then(r=>r.json()).then(data=>{
setBank(data)
}).catch(err=>console.error("Erro ao carregar perguntas:",err))

const saved=localStorage.getItem('espiriquiz-game')
if(saved){
const data=JSON.parse(saved)
setXP(data.xp||0)
setLevel(data.level||1)
setStreak(data.streak||0)
setLastLogin(data.lastLogin)
setBadges(data.badges||[])
}
checkDailyLogin()
generateMissions()
},[])

useEffect(()=>{
if(!blitzMode||view!=='game'||selectedAnswer!==null)return
const t=setInterval(()=>{
setBlitzTimer(prev=>{
if(prev<=1){answer(-1);return 15}
return prev-1
})
},1000)
return()=>clearInterval(t)
},[blitzMode,view,selectedAnswer])

async function callGeminiAPI(prompt){
if(GEMINI_API_KEY==='SUA_CHAVE_API_AQUI'){
return "âš ï¸ Configure a chave API no cÃ³digo HTML (linha 45).\n\nObtenha grÃ¡tis em: https://makersuite.google.com/app/apikey"
}
try{
const response=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`,{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({
contents:[{
parts:[{text:prompt}]
}]
})
})

if(!response.ok){
const errorData=await response.json().catch(()=>({error:{message:'Erro desconhecido'}}))
console.error('Erro API:',errorData)
if(response.status===404){
return "âŒ Erro 404: Modelo nÃ£o encontrado.\n\nSua chave pode estar invÃ¡lida ou expirada.\nGere uma nova em: https://makersuite.google.com/app/apikey"
}
if(response.status===429){
return "â³ Limite de requisiÃ§Ãµes excedido.\n\nAguarde alguns minutos ou verifique sua quota em:\nconsole.cloud.google.com"
}
if(response.status===400){
return "âŒ Erro 400: RequisiÃ§Ã£o invÃ¡lida.\n\nVerifique se sua chave estÃ¡ ativa."
}
return `âŒ Erro ${response.status}: ${errorData.error?.message||'Erro ao conectar com IA'}`
}

const data=await response.json()

if(data.candidates&&data.candidates[0]&&data.candidates[0].content&&data.candidates[0].content.parts){
return data.candidates[0].content.parts[0].text
}

if(data.promptFeedback?.blockReason){
return "âš ï¸ Resposta bloqueada por filtros de seguranÃ§a.\n\nTente reformular a pergunta."
}

return "âŒ NÃ£o foi possÃ­vel gerar resposta.\n\nTente novamente."

}catch(error){
console.error('Erro Gemini:',error)
return `âŒ Erro de conexÃ£o: ${error.message}\n\nVerifique:\nâ€¢ ConexÃ£o com internet\nâ€¢ Chave API configurada (linha 45)\nâ€¢ Firewall/antivÃ­rus`
}
}

async function generateMentorTip(){
if(!questions[idx])return
setLoadingAI(true)
const q=questions[idx]
const prompt=`VocÃª Ã© um mentor espÃ­rita sÃ¡bio que usa o mÃ©todo socrÃ¡tico.

Pergunta do estudante: "${q.question}"

ForneÃ§a uma dica pedagÃ³gica que:
- NÃƒO revele a resposta direta
- FaÃ§a 2-3 perguntas que guiem o raciocÃ­nio
- Use analogias da doutrina espÃ­rita
- MÃ¡ximo de 4 frases curtas

Seja um mentor socrÃ¡tico, nÃ£o um professor.`

const tip=await callGeminiAPI(prompt)
setAiMentorTip(tip)
gainXP(25)
setLoadingAI(false)
}

async function generateDeepDive(){
if(!questions[idx])return
setLoadingAI(true)
const q=questions[idx]
const correct=q.options[q.correct]
const prompt=`VocÃª Ã© um estudioso da doutrina espÃ­rita codificada por Allan Kardec.

Pergunta: "${q.question}"
Resposta correta: "${correct}"

Explique de forma profunda (4-5 parÃ¡grafos):
1. POR QUE esta Ã© a resposta correta segundo a lÃ³gica kardecista
2. BASE FILOSÃ“FICA desta verdade
3. Como se relaciona com outros princÃ­pios da doutrina
4. AplicaÃ§Ã£o prÃ¡tica desta verdade

Use linguagem clara mas profunda. Cite a racionalidade do Espiritismo.`

const dive=await callGeminiAPI(prompt)
setAiDeepDive(dive)
gainXP(25)
setLoadingAI(false)
}

function gainXP(amount){
const newXP=xp+amount
let newLevel=level
const curr=LEVELS[newLevel-1]
if(newXP>=curr.maxXP&&newLevel<6){
newLevel++
alert(`ğŸ‰ Subiu para NÃ­vel ${newLevel}!`)
}
setXP(newXP)
setLevel(newLevel)
save({xp:newXP,level:newLevel})
}

function unlockBadge(id){
if(badges.includes(id))return
setBadges([...badges,id])
gainXP(200)
alert(`ğŸ… Badge: ${BADGES.find(b=>b.id===id)?.name}!`)
}

function checkDailyLogin(){
const today=new Date().toDateString()
if(lastLogin===today)return
const yesterday=new Date()
yesterday.setDate(yesterday.getDate()-1)
const newStreak=lastLogin===yesterday.toDateString()?streak+1:1
setStreak(newStreak)
setLastLogin(today)
gainXP(100+newStreak*10)
if(newStreak===7)unlockBadge('streak7')
if(newStreak===30)unlockBadge('streak30')
save({streak:newStreak,lastLogin:today})
}

function generateMissions(){
const all=[
{id:1,text:'Acerte 10 perguntas',target:10,current:0,xp:100},
{id:2,text:'Jogue 3 partidas',target:3,current:0,xp:150},
{id:3,text:'Jogue modo Blitz',target:1,current:0,xp:200}
]
setMissions(all)
}

function save(data){
const current=JSON.parse(localStorage.getItem('espiriquiz-game')||'{}')
localStorage.setItem('espiriquiz-game',JSON.stringify({...current,...data,xp,level,streak,lastLogin,badges}))
}

function start(mode){
let filtered=bank
if(selectedChapter!=="Todos"){
filtered=bank.filter(q=>q.chapter&&q.chapter.includes(selectedChapter))
}
if(filtered.length===0){
alert('âš ï¸ Nenhuma pergunta encontrada para este capÃ­tulo!')
filtered=bank
}
const num=mode==='blitz'?20:difficulty==="easy"?10:difficulty==="hard"?20:15
let sel=[...filtered].sort(()=>Math.random()-.5).slice(0,Math.min(num,filtered.length))

sel=sel.map(q=>{
const correctAnswer=q.options[q.correct]
const shuffledOptions=shuffleArray(q.options)
const newCorrectIndex=shuffledOptions.indexOf(correctAnswer)
return{
...q,
options:shuffledOptions,
correct:newCorrectIndex
}
})

setQuestions(sel)
setIdx(0)
setScore(0)
setView("game")
setStartTime(Date.now())
setBlitzMode(mode==='blitz')
setStudyMode(mode==='study')
setAiMentorTip(null)
setAiDeepDive(null)
setBlitzTimer(15)
}

function answer(i){
if(selectedAnswer!==null)return
setSelectedAnswer(i)
const correct=i===questions[idx].correct
setFeedback(correct)
if(correct){
const pts=difficulty==="easy"?500:difficulty==="hard"?2000:1000
setScore(s=>s+pts)
gainXP(50)
if(blitzMode)gainXP(blitzTimer*5)
}else{
if(!studyMode){
setTimeout(endGame,2000)
}
}
}

function next(){
setFeedback(null)
setSelectedAnswer(null)
setBlitzTimer(15)
setAiMentorTip(null)
setAiDeepDive(null)
if(idx+1>=questions.length){
endGame(true)
}else{
setIdx(i=>i+1)
}
}

function endGame(victory=false){
if(victory){
gainXP(200)
unlockBadge('first')
const maxScore=questions.length*(difficulty==="easy"?500:difficulty==="hard"?2000:1000)
if(score>=maxScore-100){unlockBadge('perfect');gainXP(500)}
const time=(Date.now()-startTime)/60000
if(time<3)unlockBadge('speed')
if(blitzMode)unlockBadge('blitz')
}
if(xp>=5000)unlockBadge('xp5k')
if(xp>=15000)unlockBadge('xp15k')
setView("end")
}

if(view==="menu")return(
<div className="min-h-screen flex flex-col items-center justify-center gap-6 p-4">
<div className="sound-control bg-slate-800/80 p-3 rounded-full cursor-pointer" onClick={()=>setSoundEnabled(!soundEnabled)}>
{soundEnabled?'ğŸ”Š':'ğŸ”‡'}
</div>
<h1 className="text-6xl font-bold glow-text mb-4">EspiriQuiz</h1>
<p className="text-purple-300">v3.2 Perfect - Todas CorreÃ§Ãµes</p>

<div className="bg-slate-800/50 p-4 rounded-xl max-w-md w-full">
<div className="flex items-center justify-between mb-2">
<div className="flex items-center gap-2">
<span className="text-3xl">{LEVELS[level-1].icon}</span>
<div>
<div className="level-badge">NÃ­vel {level}</div>
<div className="text-xs text-slate-400">{LEVELS[level-1].name}</div>
</div>
</div>
<div className="text-right">
<div className="text-2xl font-bold" style={{color:LEVELS[level-1].color}}>{xp.toLocaleString()}</div>
<div className="text-xs text-slate-400">XP</div>
</div>
</div>
<div className="w-full bg-slate-700 rounded-full h-2">
<div className="xp-bar" style={{width:`${((xp-LEVELS[level-1].minXP)/(LEVELS[level-1].maxXP-LEVELS[level-1].minXP))*100}%`}}/>
</div>
</div>

<div className="bg-gradient-to-r from-orange-600/20 to-red-600/20 border border-orange-500/30 p-4 rounded-xl max-w-md w-full">
<div className="flex items-center justify-between">
<div className="flex items-center gap-3">
<span className={`text-4xl ${streak>0?'streak-fire':''}`}>ğŸ”¥</span>
<div>
<div className="text-2xl font-bold text-orange-400">{streak} dias</div>
<div className="text-xs text-slate-400">SequÃªncia</div>
</div>
</div>
{lastLogin===new Date().toDateString()&&<div className="bg-green-600/30 px-3 py-1 rounded-full text-xs">âœ“ Hoje</div>}
</div>
</div>

<div className="bg-slate-900/50 p-4 rounded-xl max-w-md w-full">
<h3 className="font-bold mb-3">ğŸ“‹ MissÃµes DiÃ¡rias</h3>
{missions.map(m=>(
<div key={m.id} className={`mission-card p-3 rounded-lg mb-2 ${m.current>=m.target?'mission-complete':'mission-incomplete'}`}>
<div className="flex justify-between items-center">
<span className="text-sm">{m.text}</span>
<span className="text-xs font-bold">{m.current}/{m.target}</span>
</div>
<div className="w-full bg-slate-700 rounded-full h-1 mt-2">
<div className="bg-green-500 h-1 rounded-full" style={{width:`${(m.current/m.target)*100}%`}}/>
</div>
</div>
))}
</div>

<div className="bg-slate-900/50 p-4 rounded-xl max-w-md w-full">
<h3 className="font-bold mb-3">ğŸ… Badges ({badges.length}/{BADGES.length})</h3>
<div className="grid grid-cols-5 gap-2">
{BADGES.slice(0,10).map(b=>{
const has=badges.includes(b.id)
return(
<div key={b.id} className={`text-center p-2 rounded ${has?'bg-slate-800':'bg-slate-900/30 opacity-30'}`}>
<div className="text-2xl">{b.icon}</div>
<div className="text-xs mt-1">{has?'âœ“':''}</div>
</div>
)
})}
</div>
</div>

<select value={difficulty} onChange={e=>setDifficulty(e.target.value)} className="bg-slate-800 border border-purple-500/30 rounded-xl px-4 py-3 max-w-md w-full">
<option value="easy">FÃ¡cil (10 perguntas)</option>
<option value="normal">Normal (15 perguntas)</option>
<option value="hard">DifÃ­cil (20 perguntas)</option>
</select>

<select value={selectedChapter} onChange={e=>setSelectedChapter(e.target.value)} className="bg-slate-800 border border-purple-500/30 rounded-xl px-4 py-3 max-w-md w-full">
<option value="Todos">Todos os CapÃ­tulos</option>
<option value="CapÃ­tulo I">CapÃ­tulo I - De Deus</option>
<option value="CapÃ­tulo II">CapÃ­tulo II - Dos EspÃ­ritos</option>
<option value="CapÃ­tulo III">CapÃ­tulo III - Lei Divina</option>
<option value="CapÃ­tulo IV">CapÃ­tulo IV - Lei de AdoraÃ§Ã£o</option>
<option value="CapÃ­tulo V">CapÃ­tulo V - Lei do Trabalho</option>
<option value="CapÃ­tulo VI">CapÃ­tulo VI - Lei de ReproduÃ§Ã£o</option>
<option value="CapÃ­tulo VII">CapÃ­tulo VII - Lei de ConservaÃ§Ã£o</option>
<option value="CapÃ­tulo VIII">CapÃ­tulo VIII - Lei de DestruiÃ§Ã£o</option>
<option value="CapÃ­tulo IX">CapÃ­tulo IX - Lei de Sociedade</option>
</select>

<p className="text-slate-400 text-sm">{bank.length} questÃµes â€¢ Blitz: 15s por pergunta</p>

<div className="flex flex-wrap gap-3 max-w-md">
<button className="btn-primary px-8 py-4 rounded-2xl font-semibold flex-1 min-w-[200px]" onClick={()=>start('normal')}>â–¶ Jogar</button>
<button className="bg-orange-600 px-6 py-4 rounded-2xl font-semibold" onClick={()=>start('blitz')}>âš¡ Blitz (15s)</button>
<button className="bg-slate-700 px-6 py-4 rounded-2xl font-semibold" onClick={()=>setView('dashboard')}>ğŸ“Š Dashboard</button>
</div>

<div className="text-slate-500 text-xs mt-4">Desenvolvido com ğŸ’œ por <span className="text-purple-400">Alessandro M. Barreto</span></div>
</div>
)

if(view==="game"&&questions[idx]){
const q=questions[idx]
const progress=((idx)/questions.length)*100
return(
<div className="min-h-screen p-4 flex items-center justify-center">
<div className="sound-control bg-slate-800/80 p-3 rounded-full cursor-pointer" onClick={()=>setSoundEnabled(!soundEnabled)}>
{soundEnabled?'ğŸ”Š':'ğŸ”‡'}
</div>
<button className="exit-button bg-red-600/80 px-4 py-2 rounded-full font-semibold" onClick={()=>{
if(confirm('Deseja realmente sair? Seu progresso serÃ¡ perdido.')){
setView("menu")
}
}}>â† Sair</button>

<div className="max-w-2xl w-full">
<div className="flex justify-between items-center mb-2">
<span className="text-sm text-purple-300">Pergunta {idx+1} de {questions.length}</span>
{!studyMode&&<span className="text-xl font-bold text-yellow-400">{score.toLocaleString()} pts de luz</span>}
</div>

<div className="w-full bg-slate-800 rounded-full h-2 mb-4">
<div className="bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full" style={{width:`${progress}%`}}/>
</div>

{!aiMentorTip&&selectedAnswer===null&&!blitzMode&&(
<button onClick={generateMentorTip} disabled={loadingAI} className="btn-secondary px-4 py-2 rounded-xl text-sm font-semibold w-full disabled:opacity-50 mb-4">
{loadingAI?<span className="loading-dots">Consultando mentor</span>:'ğŸ§  Dica do Mentor (IA)'}
</button>
)}

{aiMentorTip&&(
<div className="ai-message text-sm mb-4">
<div className="font-semibold text-cyan-300 mb-2">ğŸ§  Mentor Espiritual:</div>
<div className="text-slate-200 whitespace-pre-line">{aiMentorTip}</div>
</div>
)}

{blitzMode&&(
<div className="text-center mb-4">
<div className={`blitz-timer ${blitzTimer<=5?'blitz-urgent':''}`}>{blitzTimer}</div>
<div className="text-sm text-slate-400">segundos</div>
</div>
)}

<div className="bg-slate-900/70 p-6 rounded-3xl card-glow mb-4">
{q.chapter&&<div className="text-xs text-cyan-400 mb-2">{q.chapter}</div>}
<p className="text-lg leading-relaxed">{q.question}</p>
</div>

<div className="space-y-3 mb-4">
{q.options.map((opt,i)=>{
const isSelected=selectedAnswer===i
const isCorrect=i===q.correct
const showResult=selectedAnswer!==null
let cls="block w-full text-left p-4 rounded-2xl transition-all "
if(showResult){
if(isSelected&&isCorrect)cls+="correct-answer text-white font-semibold"
else if(isSelected&&!isCorrect)cls+="wrong-answer text-white font-semibold"
else if(isCorrect)cls+="bg-green-600/50 border-2 border-green-400"
else cls+="bg-slate-800/30 text-slate-500"
}else{
cls+="bg-slate-800/70 hover:bg-purple-700/40 card-glow cursor-pointer"
}
return(
<button key={i} onClick={()=>answer(i)} disabled={selectedAnswer!==null} className={cls}>
<span className="inline-block w-7 h-7 bg-purple-600/30 rounded-full text-center leading-7 mr-3 font-semibold text-xs">{String.fromCharCode(65+i)}</span>
{opt}
</button>
)
})}
</div>

{feedback===true&&!aiDeepDive&&(
<button onClick={generateDeepDive} disabled={loadingAI} className="btn-success px-4 py-2 rounded-xl text-sm font-semibold w-full disabled:opacity-50 mb-3">
{loadingAI?<span className="loading-dots">Gerando explicaÃ§Ã£o</span>:'ğŸ“š Aprofundamento DoutrinÃ¡rio (IA)'}
</button>
)}

{aiDeepDive&&(
<div className="ai-message text-sm mb-3">
<div className="font-semibold text-green-300 mb-2">ğŸ“š Aprofundamento DoutrinÃ¡rio:</div>
<div className="text-slate-200 whitespace-pre-line">{aiDeepDive}</div>
</div>
)}

{feedback!==null&&(
<button className="btn-primary px-6 py-4 rounded-xl font-semibold w-full text-lg" onClick={next}>
{feedback?'â¡ï¸ PrÃ³xima Pergunta':'â¡ï¸ Continuar'}
</button>
)}
</div>
</div>
)
}

if(view==="dashboard")return(
<div className="min-h-screen p-6">
<button className="btn-primary px-6 py-3 rounded-xl mb-6" onClick={()=>setView("menu")}>â† Voltar</button>
<h2 className="text-3xl font-bold mb-6">ğŸ“Š Dashboard</h2>
<div className="grid gap-6 max-w-4xl">
<div className="bg-slate-900/50 p-6 rounded-xl">
<h3 className="font-bold mb-4">ğŸ“ˆ EvoluÃ§Ã£o de XP</h3>
<div className="flex items-end gap-2 h-40">
{[100,300,600,1200,2000,xp].map((val,i)=>(
<div key={i} className="flex-1 flex flex-col justify-end">
<div className="bg-gradient-to-t from-purple-600 to-pink-600 rounded-t transition-all" style={{height:`${Math.min((val/3000)*100,100)}%`}}/>
<div className="text-xs text-center mt-1">{i+1}</div>
</div>
))}
</div>
</div>
<div className="bg-slate-900/50 p-6 rounded-xl">
<h3 className="font-bold mb-4">ğŸ… Conquistas</h3>
<div className="grid grid-cols-2 gap-4">
<div className="bg-slate-800 p-4 rounded-xl">
<div className="text-3xl mb-2">âœ¨</div>
<div className="text-2xl font-bold text-purple-400">NÃ­vel {level}</div>
<div className="text-sm text-slate-400">{LEVELS[level-1].name}</div>
</div>
<div className="bg-slate-800 p-4 rounded-xl">
<div className="text-3xl mb-2">ğŸ…</div>
<div className="text-2xl font-bold text-yellow-400">{badges.length}/{BADGES.length}</div>
<div className="text-sm text-slate-400">Badges</div>
</div>
<div className="bg-slate-800 p-4 rounded-xl">
<div className="text-3xl mb-2">ğŸ”¥</div>
<div className="text-2xl font-bold text-orange-400">{streak}</div>
<div className="text-sm text-slate-400">Dias</div>
</div>
<div className="bg-slate-800 p-4 rounded-xl">
<div className="text-3xl mb-2">â­</div>
<div className="text-2xl font-bold text-cyan-400">{xp.toLocaleString()}</div>
<div className="text-sm text-slate-400">XP Total</div>
</div>
</div>
</div>
</div>
</div>
)

if(view==="end")return(
<div className="min-h-screen flex flex-col items-center justify-center gap-6 p-6">
<h2 className="text-4xl font-bold glow-text">ParabÃ©ns!</h2>
<div className="bg-slate-900/50 p-8 rounded-3xl card-glow max-w-md w-full">
<div className="text-center mb-6">
<div className="text-6xl font-bold text-yellow-400 mb-2">{score.toLocaleString()}</div>
<div className="text-slate-400">pontos de luz</div>
</div>
<div className="space-y-3 text-sm">
<div className="flex justify-between bg-slate-800/50 p-3 rounded-xl">
<span className="text-slate-400">Perguntas</span>
<span className="font-semibold">{idx+1}/{questions.length}</span>
</div>
<div className="flex justify-between bg-slate-800/50 p-3 rounded-xl">
<span className="text-slate-400">NÃ­vel</span>
<span className="font-semibold text-purple-400">NÃ­vel {level}</span>
</div>
<div className="flex justify-between bg-slate-800/50 p-3 rounded-xl">
<span className="text-slate-400">XP Total</span>
<span className="font-semibold text-green-400">{xp.toLocaleString()}</span>
</div>
</div>
</div>
<div className="flex gap-3">
<button className="btn-primary px-8 py-3 rounded-2xl font-semibold" onClick={()=>start('normal')}>ğŸ”„ Novamente</button>
<button className="bg-slate-700 px-8 py-3 rounded-2xl font-semibold" onClick={()=>setView("menu")}>ğŸ  Menu</button>
</div>
</div>
)

return<div className="min-h-screen flex items-center justify-center"><div className="text-2xl">Carregando...</div></div>
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>)
</script>
</body>
</html>
